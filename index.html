<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>IITB Canteen & Mess Hygiene Complaint Form</title>
  <style>
    /* … your existing CSS … */
  </style>
</head>
<body>
  <h1>IITB Canteen & Mess Hygiene Complaint Form</h1>

  <!-- Hidden iframe to receive the POST response -->
  <iframe name="submitFrame" style="display:none;" onload="onFormSubmitted()"></iframe>

  <form id="reviewForm"
        action="https://script.google.com/macros/s/AKfycbwYn_0IjTDSNccMtgEJwSSR5ipLipaDZG0vrDukaAgAEsBUumu0aARTmsD9IemJRQcW2Q/exec"
        method="POST" target="submitFrame"
        enctype="multipart/form-data">

    <label for="email">Your IITB Email</label>
    <input type="email" id="email" name="email" required>

    <label for="visitDate">Date of Visit</label>
    <input type="date" id="visitDate" name="visitDate" required>

    <label for="eaterie">Eaterie Name</label>
    <input type="text" id="eaterie" name="eaterie" required>

    <!-- Overall Star Rating -->
    <label>Overall Star Rating:</label>
    <div class="stars">
      <input type="radio" id="overall5" name="overallRating" value="5">
        <label for="overall5">&#9733;</label>
      <input type="radio" id="overall4" name="overallRating" value="4">
        <label for="overall4">&#9733;</label>
      <input type="radio" id="overall3" name="overallRating" value="3">
        <label for="overall3">&#9733;</label>
      <input type="radio" id="overall2" name="overallRating" value="2">
        <label for="overall2">&#9733;</label>
      <input type="radio" id="overall1" name="overallRating" value="1">
        <label for="overall1">&#9733;</label>
    </div>

    <!-- Food Quality -->
    <label>Food Quality:</label>
    <div class="stars">
      <input type="radio" id="food5" name="foodRating" value="5">
        <label for="food5">&#9733;</label>
      <input type="radio" id="food4" name="foodRating" value="4">
        <label for="food4">&#9733;</label>
      <input type="radio" id="food3" name="foodRating" value="3">
        <label for="food3">&#9733;</label>
      <input type="radio" id="food2" name="foodRating" value="2">
        <label for="food2">&#9733;</label>
      <input type="radio" id="food1" name="foodRating" value="1">
        <label for="food1">&#9733;</label>
    </div>

    <!-- Cleanliness & Hygiene -->
    <label>Cleanliness & Hygiene:</label>
    <div class="stars">
      <input type="radio" id="hygiene5" name="hygieneRating" value="5">
        <label for="hygiene5">&#9733;</label>
      <input type="radio" id="hygiene4" name="hygieneRating" value="4">
        <label for="hygiene4">&#9733;</label>
      <input type="radio" id="hygiene3" name="hygieneRating" value="3">
        <label for="hygiene3">&#9733;</label>
      <input type="radio" id="hygiene2" name="hygieneRating" value="2">
        <label for="hygiene2">&#9733;</label>
      <input type="radio" id="hygiene1" name="hygieneRating" value="1">
        <label for="hygiene1">&#9733;</label>
    </div>

    <!-- Type of Service -->
    <label>Type of Service</label>
    <div class="inline">
      <input type="radio" name="serviceType" value="Dine In" required> Dine In
    </div>
    <div class="inline">
      <input type="radio" name="serviceType" value="Takeaway"> Takeaway
    </div>
    <div class="inline">
      <input type="radio" name="serviceType" value="Delivery"> Delivery
    </div>

    <!-- Meal Time -->
    <label>Meal Time</label>
    <div class="inline"><input type="checkbox" name="mealTime" value="Breakfast"> Breakfast</div>
    <div class="inline"><input type="checkbox" name="mealTime" value="Brunch"> Brunch</div>
    <div class="inline"><input type="checkbox" name="mealTime" value="Lunch"> Lunch</div>
    <div class="inline"><input type="checkbox" name="mealTime" value="Dinner"> Dinner</div>
    <div class="inline"><input type="checkbox" name="mealTime" value="Snacks"> Snacks</div>
    <div class="inline"><input type="checkbox" name="mealTime" value="Other"> Other</div>

    <!-- Hygiene Complaints -->
    <label>Hygiene Complaints (Check all that apply)</label>
    <div><input type="checkbox" name="hygieneComplaints" value="Unclean tables or floors"> Unclean tables or floors</div>
    <div><input type="checkbox" name="hygieneComplaints" value="Dirty utensils or plates"> Dirty utensils or plates</div>
    <div><input type="checkbox" name="hygieneComplaints" value="No hand-wash station"> No hand-wash station</div>
    <div><input type="checkbox" name="hygieneComplaints" value="Pests noticed"> Pests (flies/rodents) noticed</div>
    <div><input type="checkbox" name="hygieneComplaints" value="Foul smells in dining area"> Foul smells in dining area</div>
    <div><input type="checkbox" name="hygieneComplaints" value="Greasy counters"> Greasy or sticky counters/surfaces</div>
    <div><input type="checkbox" name="hygieneComplaints" value="Food spillage not cleaned"> Food spillage not cleaned</div>
    <div><input type="checkbox" name="hygieneComplaints" value="Improper food storage"> Improper food storage</div>

    <!-- Detailed Feedback -->
    <label for="detailedFeedback">Detailed Feedback</label>
    <textarea id="detailedFeedback" name="detailedFeedback" rows="4" required></textarea>

    <!-- Picture Upload -->
    <label for="reviewImage">Upload a Picture (optional)</label>
    <input type="file" id="reviewImage" name="reviewImage"   accept="image/*"
           capture="environment" style="margin-bottom:16px;">

    <button type="submit">Submit Review</button>
  </form>


  <div class="reviews">
    <h2>Recent Reviews</h2>
    <div id="reviewsList"></div>
  </div>


  <script>
    // JSONP loader: no CORS required
    function loadReviews() {
      const cb = "renderReviews";
      const s = document.createElement("script");
      s.src = 
        "https://script.google.com/macros/s/AKfycbwYn_0IjTDSNccMtgEJwSSR5ipLipaDZG0vrDukaAgAEsBUumu0aARTmsD9IemJRQcW2Q/exec"
        + "?callback=" + cb;
      document.body.appendChild(s);
    }

    // Called by the JSONP response
    function renderReviews(rows) {
      const data = rows.slice(1).slice(-5).reverse();
      const container = document.getElementById("reviewsList");
      container.innerHTML = "";
      data.forEach(r => {
        const div = document.createElement("div");
        div.className = "review";
        div.innerHTML = `
          <h4>${r[2]}</h4>
          <p><strong>Date:</strong> ${r[1]} | <strong>Email:</strong> ${r[0]}</p>
          <p><strong>Service:</strong> ${r[3]} | <strong>Meal:</strong> ${r[4]}</p>
          <p><strong>Ratings:</strong> Overall ${r[5]}★ | Food ${r[6]}★ | Hygiene ${r[7]}★</p>
          <p><strong>Complaints:</strong> ${r[8]}</p>
          <p>${r[9]}</p>
          ${r[10]
            ? `<img src="${r[10]}" style="max-width:150px;margin-top:8px;border-radius:6px;">`
            : ""}
        `;
        container.appendChild(div);
      });
    }

    // Show alert + reload reviews after each submit
    function onFormSubmitted() {
      alert("Submitted successfully!");
      document.getElementById("reviewForm").reset();
      loadReviews();
    }

    // kick things off on page load
    loadReviews();
  </script>
</body>
</html>
